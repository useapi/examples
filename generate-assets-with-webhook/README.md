## Automating Asset Generation with the Midjourney API (using webhook)

### Introduction

If you are a designer, a game developer, or simply experimenting with [Midjourney](https://midjourney.com) and want to create a large number of [/imagine](https://docs.midjourney.com/docs/quick-start#5-use-the-imagine-command) generations based on your ideas, it may be very tedious and time-consuming to do so manually.

In this article, we will explore methods to efficiently execute such tasks with minimal effort.   

We will also attempt to measure the time it takes to generate 200 Midjourney /imagine generations.

Please check a [YouTube video](https://youtu.be/SIiPnTJ9SHU) covering similar case from other article.

This article explains how to use a `webhook` to retrieve generated results and how to structure a basic query to feed requests to the API. This approach is much more performant and consumes fewer resources.

### Setup 

We will use the Midjourney API provided by [useapi.net](https://useapi.net) to interact with Midjourney.

To get started, you'll need a Discord account with an active [Midjourney subscription](https://docs.midjourney.com/docs/plans#plan-comparison). The $10 Basic Plan will suffice.

Follow these [simple steps](https://useapi.net/docs/start-here) to obtain the following:

- Discord server id number, referred to in this article as `server`.
- Discord channel id number, referred to in this article as `channel`.
- Discord token, referred to in this article as `discord`. [Verify Discord access](https://useapi.net/docs/start-here/setup-midjourney#verify-discord-access).
- [useapi.net](https://useapi.net) API token, referred to in this article as `token`. [Verify useapi.net API access](https://useapi.net/docs/start-here/setup-useapi#verify-useapinet-api-access).

Useapi.net provides an easy way to experiment with all API endpoints without writing any code. Check the `Try It` section at the end of each document page, such as [jobs/imagine](https://useapi.net/docs/api-v2/post-jobs-imagine#try-it).

For your convenience, we have published all the [code](https://github.com/useapi/examples/tree/main/generate-assets-with-webhook) used in this article. You can choose between JavaScript and Python examples. Clone this repository locally and use it as a starting point for your experiments.

### Ngrok 

Follow official [instructions](https://ngrok.com/docs/getting-started/#step-2-connect-your-account) to sign up for an ngrok account and copy your ngrok `authtoken` from your ngrok dashboard.

### Preparing Midjourney Prompts

Let's use [ChatGPT](https://chat.openai.com) to create a list of prompts. Here's our ChatGPT prompt:

> Create a JSON array of strings with 200 Midjourney prompts. Each prompt should describe a popular actor or actress in an awkward situation, solving strange and unusual problems using the strength and skills of popular characters they have portrayed.

The output will look something like this:

```json
[
  "Robert Downey Jr. as Iron Man trying to fix a broken espresso machine using his suit's advanced technology.",
  "Scarlett Johansson as Black Widow attempting to unlock a complex safe while blindfolded at a magician's challenge.",
  "Chris Hemsworth as Thor trying to jump-start a car with Mjolnir during a thunderstorm.",
  ...  
  "Will Smith as Agent J from Men in Black dealing with a malfunctioning printer that's printing alien languages."
]
```

An array of prompts generated by ChatGPT needs to be saved to a locally cloned [prompts.json](https://github.com/useapi/examples/blob/main/generate-assets-with-webhook/prompts.json) file.

### Executing Prompts Using the Midjourney API

Create a file locally in the same folder named `example.sh` with the following content:

#### [JavaScript](https://github.com/useapi/examples/blob/main/generate-assets-with-webhook/example.js)
```bash
USEAPI_TOKEN="useapi API token" USEAPI_SERVER="Discord server" USEAPI_CHANNEL="Discord channel" USEAPI_DISCORD="Discord token" NGROK_AUTHTOKEN="ngrok authtoken" node ./example.js
```

#### [Python](https://github.com/useapi/examples/blob/main/generate-assets-with-webhook/example.py)
```bash
USEAPI_TOKEN="useapi API token" USEAPI_SERVER="Discord server" USEAPI_CHANNEL="Discord channel" USEAPI_DISCORD="Discord token" NGROK_AUTHTOKEN="ngrok authtoken" python3 ./example.py
```

Execute it from the command line like this: `./example.sh` and observe the magic of the API. We have previously created a [YouTube video](https://youtu.be/SIiPnTJ9SHU) covering similar  process.

The generated images will be saved locally. You can continue the generation process in a Discord channel to refine your desired creations, or you can use the [jobs/button](https://useapi.net/docs/api-v2/post-jobs-button) to automate it, following the same process as demonstrated above.

### Conclusion

We recently completed three consecutive runs of the code presented here, using a Standard subscription with 3 concurrent jobs using `--relax` mode.   
The results were as follows:
- 104 mins
- 102 mins
- 119 mins

Visit our [Discord Server](https://discord.gg/w28uK3cnmF) or [Telegram Channel](https://t.me/use_api) for any support questions and concerns. 

We regularly post guides and tutorials on the [YouTube Channel](https://www.youtube.com/@midjourneyapi).